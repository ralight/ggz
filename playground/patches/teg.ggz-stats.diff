diff -Nur comp.teg-0.11.0/ggz/README teg-0.11.0/ggz/README
--- comp.teg-0.11.0/ggz/README	2004-06-13 00:31:06.000000000 +0200
+++ teg-0.11.0/ggz/README	2004-06-13 00:54:29.000000000 +0200
@@ -1,29 +1,32 @@
 Making TEG work with GGZ
 ------------------------
 
-since TEG v0.9.3 works with GGZ v0.0.5 (the actual version is 0.0.5pre)
-
-
-from TEG v0.6.0 until v0.9.2, TEG works with GGZ v0.0.4
-
-
 Download GGZ from:
-	http://ggz.sourceforge.net
+	http://www.ggzgamingzone.org/
 
+Supported features:
+	(x) game spectators
+	(x) statistics
+	(x) bots
 
 Installing TEG with GGZ
 -----------------------
 
-As always:
+First, you'll have to switch on ggz mode.
+This needs ggzmod, ggzdmod, ggz-config and ggzd installed.
 
    ./configure --enable-ggz=yes
+
+Then, install as always:
+
    make
    su -
    make install
 
+History
+-------
+
+since TEG 0.11+ works with GGZ v0.0.9 including statistics
+since TEG v0.9.3 works with GGZ v0.0.5 (the actual version is 0.0.5pre)
+from TEG v0.6.0 until v0.9.2, TEG works with GGZ v0.0.4
 
-   Then:
-    cd ggz
-    ggz-config --install --modfile=tegclient.dsc
-    cp teg.dsc /usr/local/etc/ggzd/games
-    cp teg.room /usr/local/etc/ggzd/rooms
diff -Nur comp.teg-0.11.0/ggz/tegclient.dsc.in teg-0.11.0/ggz/tegclient.dsc.in
--- comp.teg-0.11.0/ggz/tegclient.dsc.in	2004-06-13 00:31:06.000000000 +0200
+++ teg-0.11.0/ggz/tegclient.dsc.in	2004-06-13 01:00:25.000000000 +0200
@@ -7,5 +7,5 @@
 Homepage = http://teg.sourceforge.net
 Name = teg
 ProtocolEngine = TEG
-ProtocolVersion = 6
-Version = 6
+ProtocolVersion = 7
+Version = @VERSION@
diff -Nur comp.teg-0.11.0/ggz/teg.dsc teg-0.11.0/ggz/teg.dsc
--- comp.teg-0.11.0/ggz/teg.dsc	2004-06-13 00:31:06.000000000 +0200
+++ teg-0.11.0/ggz/teg.dsc	2004-06-13 01:36:37.000000000 +0200
@@ -10,10 +10,14 @@
 
 [Protocol]
 Engine = TEG
-Version = 6
+Version = 7
 
 [TableOptions]
 AllowLeave = 1
 BotsAllowed =  1..6
 PlayersAllowed = 2..6
 AllowSpectators = 1
+
+[Statistics]
+Records = 1
+Ratings = 1
diff -Nur comp.teg-0.11.0/ggz/teg.dsc.in teg-0.11.0/ggz/teg.dsc.in
--- comp.teg-0.11.0/ggz/teg.dsc.in	2004-06-13 00:31:06.000000000 +0200
+++ teg-0.11.0/ggz/teg.dsc.in	2004-06-13 01:36:41.000000000 +0200
@@ -10,10 +10,14 @@
 
 [Protocol]
 Engine = TEG
-Version = 6
+Version = 7
 
 [TableOptions]
 AllowLeave = 1
 BotsAllowed =  1..6
 PlayersAllowed = 2..6
 AllowSpectators = 1
+
+[Statistics]
+Records = 1
+Ratings = 1
diff -Nur comp.teg-0.11.0/README teg-0.11.0/README
--- comp.teg-0.11.0/README	2004-06-13 00:31:06.000000000 +0200
+++ teg-0.11.0/README	2004-06-13 00:57:00.000000000 +0200
@@ -3,3 +3,9 @@
 strategy game. Some rules are different.
 
 http://teg.sourceforge.net
+
+It can be configured to support the GGZ Gaming Zone; see the GGZ
+directory.
+
+http://www.ggzgamingzone.org/games/teg/
+
diff -Nur comp.teg-0.11.0/README.GGZ teg-0.11.0/README.GGZ
--- comp.teg-0.11.0/README.GGZ	2004-06-13 00:31:06.000000000 +0200
+++ teg-0.11.0/README.GGZ	1970-01-01 01:00:00.000000000 +0100
@@ -1,46 +0,0 @@
-GGZ:
-----
-
-GGZ is GGZ GAMING ZONE
-http://ggz.sourceforge.net
-
-TEG, since version 0.6.0 (until v0.9.2) has support for GGZ v0.0.4
-TEG version 0.9.3 has support for GGZ v0.0.5
-
-By default, TEG is NOT compiled with ggz support, 
-You need to do this:
-	./configure --enable-ggz=yes
-
-`tegserver' and `tegclient' will be invoked by the ggz client
-and ggz server with `--ggz' command line option.
-
-So, the game will run in standard mode (standalone mode) by
-default. And if you want to run in ggz mode, just run the
-ggz client, that it will enable the ggz mode passing the
---ggz as a command line option.
-
-
-Installing the *.dsc files:
----------------------------
-
-In the ggz/ subdir, are two files:
-	tegclient.dsc	-> teg client dsc file
-	teg.dsc		-> teg server dsc file
-	teg.room	-> teg server room file
-
-You must have ggz installed and the run:
-	ggz-config --install --modfile=./ggz/tegclient.dsc	
-
-	cp ./ggz/teg.dsc `ggz-config -c`/ggzd/games
-	cp ./ggz/teg.room `ggz-config-c`/ggzd/rooms
-
-
-Running:
---------
-	You'll need to have ggz and teg installed.
-
-	run:
-		ggzd	(the ggz server)
-		ggz-gtk	(the ggz-gtk client)
-
-		log in, enter in the TEG room and launch teg.
diff -Nur comp.teg-0.11.0/server/ggz_server.c teg-0.11.0/server/ggz_server.c
--- comp.teg-0.11.0/server/ggz_server.c	2004-06-13 00:31:06.000000000 +0200
+++ teg-0.11.0/server/ggz_server.c	2004-06-13 01:36:06.000000000 +0200
@@ -39,6 +39,7 @@
 
 #include <ggzdmod.h>
 #include <ggzdmod-ggz.h>
+#include <ggz_stats.h>
 
 static GGZdMod *g_ggzdmod = NULL;
 
@@ -64,7 +65,7 @@
 
 	/* Setup GGZ game module */
 	ggzdmod_set_handler(g_ggzdmod, GGZDMOD_EVENT_STATE, &_handle_ggz_state);
-        ggzdmod_set_handler(g_ggzdmod, GGZDMOD_EVENT_LOG, &_handle_ggz_log);
+	ggzdmod_set_handler(g_ggzdmod, GGZDMOD_EVENT_LOG, &_handle_ggz_log);
 	ggzdmod_set_handler(g_ggzdmod, GGZDMOD_EVENT_ERROR, &_handle_ggz_error);
 
 	ggzdmod_set_handler(g_ggzdmod, GGZDMOD_EVENT_JOIN, &_handle_ggz_join);
@@ -243,6 +244,32 @@
 	return TEG_STATUS_ERROR;
 }
 
+void ggz_server_gameover( int fd )
+{
+	int max, i;
+	GGZSeat seat;
+	GGZStats *stats;
+	GGZGameResult results[TEG_MAX_PLAYERS];
+
+	stats = ggzstats_new( g_ggzdmod );
+	max = ggzdmod_get_num_seats( g_ggzdmod );
+
+	for(i=0;i<max;i++) {
+		seat = ggzdmod_get_seat( g_ggzdmod, i );
+		if( seat.fd == fd ) {
+			ggzstats_set_game_winner( stats, i, 1.0 );
+			results[i] = GGZ_GAME_WIN;
+		} else {
+			ggzstats_set_game_winner( stats, i, 0.0 );
+			results[i] = GGZ_GAME_LOSS;
+		}
+	}
+
+	ggzdmod_report_game( g_ggzdmod, NULL, results );
+	ggzstats_recalculate_ratings( stats );
+	ggzstats_free(stats);
+}
+
 int ggz_server_main_loop()
 {
 	if( teg_ggz_init() == -1 )
diff -Nur comp.teg-0.11.0/server/ggz_server.h teg-0.11.0/server/ggz_server.h
--- comp.teg-0.11.0/server/ggz_server.h	2004-06-13 00:31:06.000000000 +0200
+++ teg-0.11.0/server/ggz_server.h	2004-06-13 01:23:03.000000000 +0200
@@ -27,5 +27,6 @@
 
 int ggz_server_main_loop();
 TEG_STATUS ggz_server_find_ggzname( int fd, char *n, int len );
+void ggz_server_gameover( int fd );
 
 #endif /* __TEGS_TEGGGZ_H */
diff -Nur comp.teg-0.11.0/server/play.c teg-0.11.0/server/play.c
--- comp.teg-0.11.0/server/play.c	2004-06-13 00:31:06.000000000 +0200
+++ teg-0.11.0/server/play.c	2004-06-13 01:22:50.000000000 +0200
@@ -693,6 +693,7 @@
 
 		/* Did 'src' player win the game ? */
 		if( mission_chequear( pJ_src ) == TEG_STATUS_GAMEOVER || game_is_finished() ) {
+			ggz_server_gameover(pJ_src->fd);
 			con_text_out(M_INF,_("Player %s(%d) is the winner! Game Over\n"),pJ_src->name,pJ_src->numjug);
 			pJ_src->estado = PLAYER_STATUS_GAMEOVER;
 			game_end( pJ_src );
